!function(n,t){"use strict";function e(){var n=t(i);return r?void(module.exports=n):window.ruta=n}var r="undefined"==typeof window||null==window.navigator,i=r?global:window;return"function"==typeof define&&define.amd?define(e):e()}(this,function(n){"use strict";function t(){return null==O&&(O=new C(q)),O}var e,r,i,u=n.mask||("undefined"!=typeof Mask?Mask:null),o=!0,a=Array.prototype.slice;!function(){e=function(n,t){if(null==t)return n||{};if(null==n)return r(t);for(var e in t)n[e]=t[e];return n},i=function(n,t){if(null==t)return n||{};if(null==n)return r(t);for(var e in t)null==n[e]&&(n[e]=t[e]);return n},r=Object.create||function(n){var t=function(){};return t.prototype=n,new t}}();var s;!function(){s=function(){var n=a.call(arguments);console.error.apply(console,["Ruta"].concat(n))}}();var l,f,c,h,p,v;!function(){function n(n){for(var t,e,r=n.trim().split(/\s+/),i=r.length,u=-1;++u<i;)if(e=r[u],0!==e.length&&(t=e[0],'"'===t||"'"===t))for(var o=u;i>u;u++)if(e=r[u],e[e.length-1]===t){var a=r.splice(o,u-o+1).join(" ").slice(1,-1);r.splice(o,0,a),i=r.length;break}return r}function t(n){for(var t,e,r,i=n.length,u=0,o={},a=[];i>u;u++)r=n[u],"-"!==r[0]?a.push(r):(t=r.replace(/^[\-]+/,""),i-1>u&&"-"!==n[u+1][0]?(e=n[u+1],u++):e=!0,o[t]=e);return{path:a,query:o}}l=function(n){for(var t=n.length,e=0,r=t-1;t>e&&"/"===n[e];e++);for(;r>e&&"/"===n[r];r--);return n.substring(e,r+1)},f=function(n){return n=l(n),""===n?[]:n.split("/")},c=function(n){return"/"+n.join("/")},h=function(e){"string"==typeof e&&(e=n(e));var r=t(e);return w(r)},p=function(n){var t=n.indexOf("?");if(-1===t)return null;var e=n.substring(t+1);return g(e,"&")},v=function(n,t){var e="string"!=typeof t?y(t,"&"):t,r=n.indexOf("?");return-1!==r&&(n=n.substring(0,r)),n+"?"+e}}();var g,y;!function(){function n(n,t,e){for(var r,i=t.split("."),u=i.length,o=-1;++o<u-1;)r=i[o],null==n[r]&&(n[r]={}),n=n[r];n[i[o]]=e}function t(n){try{return decodeURIComponent(n)}catch(t){return s("decode:URI malformed"),""}}function e(n){try{return encodeURIComponent(n)}catch(t){return s("encode:URI malformed"),""}}g=function(e,r){null==r&&(r="&");for(var i,u,o={},a=e.split(r),s=0,l=a.length;l>s;s++)i=a[s].split("="),u=null==i[1]?"":t(i[1]),n(o,i[0],u);return o},y=function(n,t){null==t&&(t="&");var r,i,u="";for(r in n)i=n[r],null!=i&&("boolean"==typeof i&&(i=null),u=u+(u?t:"")+r,i&&(u+="="+e(i)));return u}}();var d,m,b;!function(){d=function(n,t){return new RegExp(n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),t)},m=function(n){if("^"===n[0])return new RegExp(n);for(var t=n.split("|"),e=0,r=t.length;r>e;e++)t[e]="^"+t[e]+"$";return new RegExp(t.join("|"))},b=function(n){var t=n.indexOf("("),e=n.lastIndexOf(")");if(-1===t||-1===e)return s("Expected alias part with regexp",n),null;var r=n.substring(t+1,e);return{alias:n.substring(1,t),matcher:m(r)}}}();var w,k;!function(){w=function(n){var t=c(n.path);return null==n.query?t:t+"?"+y(n.query,"&")},k=function(n){var t=n.indexOf("?"),e=-1===t?n:n.substring(0,t);return{path:f(e),query:-1===t?null:g(n.substring(t+1),"&")}}}();var x;!function(){function n(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function n(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}var t,e;!function(){function n(n,t){for(var e in n)if(t.test(e))return n[e]}function r(n){this.str=n}function i(n){this.str=n}t=function(n,t){var e=t.charCodeAt(0);switch(e){case 33:n.strict=!0,t=t.substring(1);break;case 94:n.strict=!1,t=t.substring(1);break;case 40:var u=1,o=t.length-1;return 41!==t.charCodeAt(t.length-1)&&(s("parser - expect group closing"),o++),void(n.match=new RegExp(t.substring(u,o)))}var a,l,f,c,h,p,v=t.split("/"),g=0,y=v.length,d=v[y-1];l=d.indexOf("?"),l>(1===y?-1:0)&&(a=d.substring(l+1),v[y-1]=d.substring(0,l));for(var b,w,k,x=!0,C=n.path=[];y>g;g++)if(f=v[g],""!==f)if(c=f.charCodeAt(0),p=f.charCodeAt(1),b=63===c,w=58===(b?p:c),h=0,b&&h++,w&&h++,0!==h&&(f=f.substring(h)),b||x||s("Strict part found after optional",t),"*"!==f){b&&(x=!1);var O=f.indexOf("(");if(w&&-1!==O){var o=f.length-1;")"!==f[o]&&(o+=1),k=new RegExp(m(f.substring(O+1,o))),f=f.substring(0,O)}b||w?w?C.push({alias:f,matcher:k,optional:b}):b&&C.push({matcher:new r(f),optional:b}):C.push(f)}else C.push({matcher:new i});if(a){var R=n.query={};v=a.split("&"),g=-1,y=v.length;for(var q,A,E,P;++g<y;)E=v[g],P=E.indexOf("="),-1!==P?(q=E.substring(0,P),A=E.substring(P+1),40===A.charCodeAt(0)&&(A=new RegExp(m(A))),R[q]=A):R[E]="";0===n.path.length&&(n.strict=!1)}},e=function(t,e){var r=e.indexOf("?"),i=-1===r?null:e.substring(r+1),u={path:e,params:null==i?{}:g(i,"&")};if(t.query)for(var o in t.query)if("?"===o[0]&&(o=o.substring(1)),":"===o[0]){var a=b(o),s=a.alias;u.params[s]=n(u.params,a.matcher)}if(-1!==r&&(e=e.substring(0,r)),null!=t.path)for(var l,c,h=f(e),p=t.path,v=p.length,y=h.length,d=0;y>d;d++)if(l=h[d],c=v>d?p[d]:null){if("string"==typeof c)continue;if(c.alias){u.params[c.alias]=l;continue}}return u},r.prototype={test:function(n){return n===this.str}},i.prototype={test:function(n){return!0}}}();var r,i,u;!function(){function n(n,t){for(var e in n)if(t.test(e))return!0;return!1}r=function(n,t,r){for(var i=k(n),o=t.length,a=-1;++a<o;){var s=t[a];if(u(i,s,r))return s.current=e(s,n),s}return null},i=function(n,t,r){for(var i=k(n),o=t.length,a=-1,s=[];++a<o;){var l=t[a];u(i,l,r)&&(l.current=e(l,n),s.push(l))}return s},u=function(t,e,r){if(null!=r&&null!=e.method&&e.method!==r)return!1;if(e.match)return e.match.test("string"==typeof t?t:w(t));if("string"==typeof t&&(t=k(t)),e.query){var i,u,o=t.query;if(null==o)return!1;for(i in e.query){u=e.query[i];var a=i[0];if(":"!==a){if("?"!==a)if("string"!=typeof u){if(u.test&&!u.test(o[i]))return!1}else{if(null==o[i])return!1;if(u&&o[i]!==u)return!1}}else{var s=b(i);if(null==s||n(o,s.matcher)===!1)return!1}}}var l=e.path,f=l.length;if(0===f)return e.strict?0===t.path.length:!0;for(var c,h=t.path,p=0,v=h.length;v>p;p++){if(c=l[p],p>=f)return e.strict!==!0;if("string"==typeof c){if(h[p]===c)continue;return!1}if(c.matcher){if(c.matcher.test(h[p])===!1)return!1}else{if(c.optional)return!0;if(!c.alias)return!1}}return f>p?l[p].optional===!0:!0}}();var a=function h(e,r){n(this,h),this.method=null;var i=e;if(36===i.charCodeAt(0)){var u=i.indexOf(" ");this.method=i.substring(1,u).toUpperCase(),i=i.substring(u+1)}this.value=r,this.strict=o,this.definition=e,this.current=null,this.query=null,this.path=null,t(this,i)},l=function(){function n(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),c=function(){function u(){n(this,u),this.routes=[]}return l(u,[{key:"add",value:function(){return this.push.apply(this,arguments)}},{key:"push",value:function(n,t){var e=new a(n,t);return this.routes.push(e),this}},{key:"unshift",value:function(n,t){var e=new a(n,t);return this.routes.unshift(e),this}},{key:"remove",value:function(n,t){for(var e=this.routes.length,r=-1;++r<e;){var i=this.routes[r];null!=n&&i.definition===n&&null!=t&&i.value===t&&(this.routes.splice(r,1),r--,e--)}}},{key:"get",value:function(n,t){return r(n,this.routes,t)}},{key:"getAll",value:function(n,t){return i(n,this.routes,t)}},{key:"clear",value:function(){return this.routes.length=0,this}}],[{key:"parse",value:function(n,r){var i={};return t(i,n),e(i,r)}}]),u}();x=c}();var C;!function(){function n(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function n(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function n(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}"undefined"==typeof window&&(C=function(){});var t=function(){function n(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),r=function(){function e(t){n(this,e),this.opts=null,this.listener=t,window.onhashchange=this.onhashchange.bind(this)}return t(e,[{key:"onhashchange",value:function(){this.changed()}},{key:"navigate",value:function(n,t){return this.opts=t,null==n?void this.changed():void(location.hash=n)}},{key:"changed",value:function(n){var t=n||this.opts;this.opts=null,this.listener.changed(this.current(),t)}},{key:"current",value:function(){return e.normalizeHash(location.hash)}}],[{key:"supports",value:function(){return"undefined"!=typeof window&&"onhashchange"in window!=!1}},{key:"normalizeHash",value:function(n){return n.replace(/^[!#\/]+/,"/")}}]),e}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},t=function(){function n(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),o=function(){function r(t){n(this,r),this.listener=t,this.initial=location.href,window.onpopstate=this.onpopstate.bind(this)}return t(r,[{key:"onpopstate",value:function(){return this.initial===location.href?void(this.initial=null):void this.changed()}},{key:"navigate",value:function(n,t){if(null==n)return void this.changed();var r="object"===("undefined"==typeof n?"undefined":u(n)),i=null;if(null!=t&&t.extend===!0){var o=r?n:p(n),a=p(location.search);if(null!=a&&null!=o){for(var s in a)void 0!==o[s]&&null===o[s]&&delete a[s];o=e(a,o),i=v(i||"",o)}}null==i&&(i=r?v("",n):n),t&&t.replace===!0?history.replaceState({},null,i):history.pushState({},null,i),this.initial=null,this.changed(t)}},{key:"changed",value:function(n){this.listener.changed(this.current(),n)}},{key:"current",value:function(){return location.pathname+location.search}}],[{key:"supports",value:function(){return"undefined"==typeof window?!1:window.history&&window.history.pushState?window.location.href===document.baseURI:!1}}]),r}(),t=function(){function n(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),a=function(){function e(t,i){if(n(this,e),this.collection=t||new x,this.listeners=new x,i){var u="hash"===i?r:o;this.emitter=new u(this)}null==this.emitter&&o.supports()&&(this.emitter=new o(this)),null==this.emitter&&r.supports()&&(this.emitter=new r(this)),null==this.emitter&&s("Router can not be initialized - (nor HistoryAPI / nor hashchange")}return t(e,[{key:"changed",value:function(n,t){if(!t||t.silent!==!0){var e=this.collection.get(n);e&&this.action(e,t);for(var r=this.listeners.getAll(n),i=r.length,u=-1;++u<i;)this.action(r[u],t)}}},{key:"action",value:function(n,t){if("function"==typeof n.value){var e=n.current,r=e&&e.params;t&&null!=t.params&&(e.params=r=i(r,t.params)),n.value(n,r)}}},{key:"navigate",value:function(n,t){this.emitter.navigate(n,t)}},{key:"current",value:function(){return this.collection.get(this.currentPath())}},{key:"currentPath",value:function(){return this.emitter.current()}},{key:"on",value:function(n,t){this.listeners.push(n,t)}},{key:"off",value:function(n,t){this.listeners.remove(n,t)}}]),e}();C=a}();var O,R={pathFromCLI:h,query:{serialize:y,deserialize:g,get:function(n){var t=null==n?location.search:n;return p(t)}}},q=new x,A={Collection:x,setRouterType:function(n){return null==O&&(O=new C(q,n)),this},setStrictBehaviour:function(n){return o=n,this},add:function(n,e){return t(),q.add(n,e),this},on:function(n,e){return t().on(n,e),this},off:function(n,e){return t().off(n,e),this},get:function(n){return q.get(n)},navigate:function(n,e){return t().navigate(n,e),this},current:function(){return t().current()},currentPath:function(){return t().currentPath()},notifyCurrent:function(){return t().navigate(),this},parse:x.parse,$utils:R,_:R};return function(){function n(n){n.preventDefault(),n.stopPropagation(),A.navigate(this.getAttribute("href"))}null!=u&&u.registerAttrHandler("x-dynamic",function(t,e,r,i,u){u.onclick=n},"client")}(),A});
//# sourceMappingURL=ruta.min.js.map