(function(n,t){"use strict";null==n&&(n="undefined"!=typeof window&&"undefined"!=typeof document?window:global),n.ruta=t(n)})(this,function(n){"use strict";function t(n){for(var t=n.length,i=0,e=t-1;t>i&&"/"===n[i];i++);for(;e>i&&"/"===n[e];e--);return n.substring(i,e+1)}function i(n){return n=t(n),""===n?[]:n.split("/")}function e(n,t){null==t&&(t="/");for(var i,e={},r=n.split(t),o=0,u=r.length;u>o;o++)i=r[o].split("="),e[i[0]]=decodeURIComponent(i[1]);return e}function r(n,t){return RegExp(n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),t)}function o(){return null==u&&(u=new s(l)),u}var u,a=n.mask||Mask,c=function(){function n(n,t){"!"===t[0]&&(n.strict=!0,t=t.substring(1));for(var i,e,o,u,a,c,s,l=t.split("/"),f=0,h=l.length,p=!0,d=[];h>f;f++)if(i=l[f],""!==i){e=i.charCodeAt(0),u=i.charCodeAt(1),a=63===e,c=58===(a?u:e),o=0,a&&o++,c&&o++,0!==o&&(i=i.substring(o)),!a&&!p&&console.log("Strict route part found after optional",t),a&&(p=!1);var g=i.indexOf("(");if(c&&-1!==g){var v=i.length-1;")"!==i[v]&&(v+=1),s=r(i.substring(g+1,v)),i=i.substring(0,g)}a||c?c&&d.push({alias:i,matcher:s,optional:a}):d.push(i)}n.parts=d}function o(n,t){var r=t.indexOf("?"),o=-1===r?null:t.substring(r+1),u={path:t,params:null==o?{}:e(o,"&")};-1!==r&&(t=t.substring(0,r));for(var a,c,s=i(t),l=n.parts,f=l.length,h=s.length,p=0;h>p;p++)if(a=s[p],c=f>p?l[p]:null){if("string"==typeof c)continue;if(c.alias){u.params[c.alias]=a;continue}}return u}function u(n,e){n=t(n);for(var r,u=n.indexOf("?"),c=-1===u?n:n.substring(0,u),s=i(c),l=0,f=e.length;f>l;l++)if(r=e[l],a(s,r))return r.current=o(r,n),r;return null}function a(n,t){"string"==typeof n&&(n=i(n));for(var e,r=t.parts,o=r.length,u=0,a=n.length;a>u;u++){if(e=r[u],u>=o)return t.strict!==!0;if("string"==typeof e){if(n[u]===e)continue;return!1}if(e.matcher&&e.matcher.test(n[u])===!1)return!1;if(e.optional)return!0;if(!e.alias)return!1}return o>u?r[u].optional===!0:!0}function c(t,i){this.value=i,this.definition=t,n(this,t)}function s(){this.routes=[]}return c.prototype={parts:null,value:null,current:null},s.prototype={add:function(n,t){return this.routes.push(new c(n,t)),this},get:function(n){return u(n,this.routes)}},s.parse=function(t,i){var e={};return n(e,t),o(e,i)},s}(),s=function(){function n(n){if("undefined"==typeof window||"onhashchange"in window==!1)return null;var t=this;return t.listener=n,window.onhashchange=function(){t.changed(location.hash)},t}function t(n){if("undefined"==typeof window)return null;if(!window.history||!window.history.pushState)return null;var t=this;return t.listener=n,t.initial=location.pathname,window.onpopstate=function(){return t.initial===location.pathname?(t.initial=null,void 0):(t.changed(),void 0)},t}function i(i,e){this.collection=i||new c,this.emitter=new t(this),e&&(this.action=e),null==this.emitter&&(this.emitter=new n(this)),null==this.emitter&&console.error("Router can not be initialized - (nor History API / nor Hashchage")}return"undefined"==typeof window?function(){}:(function(){function t(n){return n.replace(/^[!#/]+/,"/")}n.prototype={navigate:function(n){location.hash=n},changed:function(n){this.listener.changed(t(n))},current:function(){return t(location.hash)}}}(),function(){t.prototype={navigate:function(n){history.pushState({},null,n),this.changed()},changed:function(){this.listener.changed(location.pathname+location.search)}}}(),i.prototype={changed:function(n){var t=this.collection.get(n);t&&this.action(t)},action:function(n){n.value(n)},navigate:function(n){this.emitter.navigate(n)},current:function(){var n=this.emitter.current();return this.collection.get(n)}},i)}(),l=new c,f={Collection:c,add:function(n,t){return o(),l.add(n,t)},get:function(n){return l.get(n)},navigate:function(n){o().navigate(n)},current:function(){return o().current()},parse:c.parse};return function(){function n(n){n.preventDefault(),n.stopPropagation(),f.navigate(this.href)}a.registerAttrHandler("x-dynamic",function(t,i,e,r,o){o.onclick=n},"client")}(),f});